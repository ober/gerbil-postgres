prelude: :gerbil/core
package: jafourni/gerbil-postgres
namespace: jafourni/gerbil-postgres/cursor

(%#begin (%#import
          :std/db/dbi
          :std/iter
          :std/sugar
          :jafourni/gerbil-postgres/errors
          :jafourni/gerbil-postgres/logging
          :jafourni/gerbil-postgres/transactions)
         (%#export
          (spec: 0 call-with-cursor call-with-cursor)
          (spec: 0 with-cursor with-cursor)
          (spec: 0 in-pg-cursor in-pg-cursor))
         (%#define-runtime
          call-with-cursor
          jafourni/gerbil-postgres/cursor#call-with-cursor)
         (%#begin (%#begin-syntax
                   (%#call (%#ref load-module)
                           (%#quote "jafourni/gerbil-postgres/cursor~1")))
                  (%#define-syntax
                   with-cursor
                   |jafourni/gerbil-postgres/cursor[:0:]#with-cursor|))
         (%#begin (%#begin (%#define-runtime
                            in-pg-cursor__%__%
                            jafourni/gerbil-postgres/cursor#in-pg-cursor__%__%)
                           (%#begin (%#define-runtime
                                     in-pg-cursor__%__0
                                     jafourni/gerbil-postgres/cursor#in-pg-cursor__%__0)
                                    (%#define-runtime
                                     in-pg-cursor__%
                                     jafourni/gerbil-postgres/cursor#in-pg-cursor__%)))
                  (%#define-runtime
                   in-pg-cursor__@
                   jafourni/gerbil-postgres/cursor#in-pg-cursor__@)
                  (%#define-runtime
                   in-pg-cursor
                   jafourni/gerbil-postgres/cursor#in-pg-cursor)))
(%#call (%#ref load-module) (%#quote "jafourni/gerbil-postgres/cursor~0"))
